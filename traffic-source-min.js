function crumbleCookie(e){for(var t=document.cookie.split(";"),r={},n=0;n<t.length;n++){var i=t[n].substring(0,t[n].indexOf("=")).trim(),a=t[n].substring(t[n].indexOf("=")+1,t[n].length).trim();r[i]=a}return e?r[e]?r[e]:null:r}function bakeCookie(e,t,r,n,i,a){var o=new Date;o.setTime(o.getTime()),r&&(r*=864e5),o=new Date(o.getTime()+r),document.cookie=e+"="+escape(t)+(r?";expires="+o.toGMTString():"")+(n?";path="+n:"")+(i?";domain="+i:"")+(a?";secure":"")}function writeLogic(e){var t=getTrafficSource(e,".zerista.com");t=(t=t.replace(/\|{2,}/g,"|")).replace(/^\|/,""),bakeCookie(e,t=unescape(t),182,"/","","")}function getParam(e,t){try{var r=e.match("[?&]"+t+"=([^&]+)");return r?r[1]:""}catch(e){return""}}function calculateTrafficSource(){var e="",t="",r="",n="",i="",a=[["bing","q"],["google","q"],["yahoo","q"],["baidu","q"],["yandex","q"],["ask","q"]],o=document.referrer;o=o.substr(o.indexOf("//")+2),ref_domain=o,ref_path="/",ref_search="";var c=document.location.search;if(-1<c.indexOf("utm_source"))e=getParam(c,"utm_source"),t=getParam(c,"utm_medium"),r=getParam(c,"utm_campaign"),n=getParam(c,"utm_term"),i=getParam(c,"utm_content");else if(getParam(c,"gclid"))e="google",t="cpc",r="(not set)";else if(o){-1<o.indexOf("/")&&(ref_domain=o.substr(0,o.indexOf("/")),ref_path=o.substr(o.indexOf("/")),-1<ref_path.indexOf("?")&&(ref_search=ref_path.substr(ref_path.indexOf("?")+1),ref_path=ref_path.substr(0,ref_path.indexOf("?")))),t="referral",e=ref_domain;for(var u=0;u<a.length;u++)if(-1<ref_domain.indexOf(a[u][0])){t="organic",e=a[u][0],n=getParam(ref_search,a[u][1])||"(not provided)";break}}return{source:e,medium:t,campaign:r,term:n,content:i}}function getTrafficSource(e,t){var r=calculateTrafficSource(),n=0===r.source.length?"direct":r.source,i=0===r.medium.length?"none":r.medium,a=0===r.campaign.length?"direct":r.campaign;"referral"===i&&(a="");var o=new Date;return"source="+n+"&medium="+i+"&campaign="+a+"&term="+r.term+"&content="+r.content+"&date="+o.toISOString().slice(0,10).replace(/-/g,"")}function getCookie(e){for(var t=e+"=",r=decodeURIComponent(document.cookie).split(";"),n=0;n<r.length;n++){for(var i=r[n];" "==i.charAt(0);)i=i.substring(1);if(0==i.indexOf(t))return i.substring(t.length,i.length)}return""}function setInputFieldWithFullCookie(e,t){document.getElementById(e).value=getCookie(t)}function setInputFieldWithSourceMedium(e,t){document.getElementById(e).value=getSourceParam(t,"source")+" / "+getSourceParam(t,"medium")}function getSourceVars(e){var n={};getCookie(e).replace(/([^=&]+)=([^&]*)/gi,function(e,t,r){n[t]=r});return n}function getSourceParam(e,t){var r="";return-1<getCookie(e).indexOf(t)&&(r=getSourceVars(e)[t]),r}!function(){var e=new Date,t=e.getUTCFullYear().toString()+(e.getUTCMonth()<9?"0"+(e.getUTCMonth()+1).toString():(e.getUTCMonth()+1).toString())+(e.getUTCDate()<10?"0"+e.getUTCDate().toString():e.getUTCDate().toString());void 0===crumbleCookie().FirstSession?writeLogic("FirstSession"):t!==getSourceParam("ReturningSession","date")&&writeLogic("ReturningSession")}();
